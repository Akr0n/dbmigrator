<Window xmlns="https://github.com/avaloniaui" 
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Class="DatabaseMigrator.Views.MainWindow"
        Title="Database Migrator" 
        Width="1400" 
        Height="900"
        WindowStartupLocation="CenterScreen"
        Background="#1a1a1a"
        Icon="avares://DatabaseMigrator/Assets/logo.ico">
    
    <DockPanel Background="#1a1a1a">
        <!-- Menu Bar -->
        <Menu DockPanel.Dock="Top" Background="#0d47a1" Foreground="White">
            <MenuItem Header="ðŸ“ File">
                <MenuItem Header="ðŸ’¾ Salva Configurazione..." x:Name="SaveConfigMenuItem"/>
                <MenuItem Header="ðŸ“‚ Carica Configurazione..." x:Name="LoadConfigMenuItem"/>
                <Separator/>
                <MenuItem Header="âŒ Esci" x:Name="ExitMenuItem"/>
            </MenuItem>
            <MenuItem Header="â“ Aiuto">
                <MenuItem Header="ðŸ“– Informazioni" x:Name="AboutMenuItem"/>
            </MenuItem>
        </Menu>

        <Border DockPanel.Dock="Top" Background="#0d47a1" Padding="20">
            <TextBlock Text="ðŸ—„ï¸ Database Migrator" FontSize="32" FontWeight="Bold" Foreground="White"/>
        </Border>

        <Grid RowDefinitions="*,Auto" Margin="20" Background="#1a1a1a">
            <TabControl Grid.Row="0" x:Name="MainTabControl" Background="#2a2a2a" Foreground="White">
                <!-- Tab 1: Connections -->
                <TabItem Background="#2a2a2a" Foreground="White" Padding="15,10">
                    <TabItem.Header>
                        <TextBlock Text="ðŸ“Š Connessioni Database" FontSize="13" Foreground="White"/>
                    </TabItem.Header>
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Background="#1a1a1a">
                        <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="*,*" Margin="20" Background="#1a1a1a">
                            <!-- Source -->
                            <Border Grid.Row="0" Grid.Column="0" Background="#2a2a2a" CornerRadius="8" Padding="20" BorderBrush="#0d47a1" BorderThickness="2" Margin="0,0,15,0">
                                <StackPanel Spacing="15">
                                    <TextBlock Text="ðŸ“¥ Database Sorgente" FontSize="16" FontWeight="Bold" Foreground="#64b5f6"/>
                                    
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="Tipo Database:" FontWeight="Bold" Foreground="#e0e0e0" FontSize="12"/>
                                        <ComboBox x:Name="SourceTypeCombo" SelectedIndex="0" Padding="10" FontSize="12" Background="#3a3a3a" Foreground="#ffffff" BorderBrush="#0d47a1" BorderThickness="1">
                                            <ComboBoxItem>SqlServer</ComboBoxItem>
                                            <ComboBoxItem>Oracle</ComboBoxItem>
                                            <ComboBoxItem>PostgreSQL</ComboBoxItem>
                                        </ComboBox>
                                    </StackPanel>
                                    
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="Server:" FontWeight="Bold" Foreground="#e0e0e0" FontSize="12"/>
                                        <TextBox x:Name="SourceServerTextBox" Watermark="localhost" Padding="10" FontSize="12" Background="#3a3a3a" Foreground="#ffffff" BorderBrush="#0d47a1" BorderThickness="1"/>
                                    </StackPanel>
                                    
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="Porta:" FontWeight="Bold" Foreground="#e0e0e0" FontSize="12"/>
                                        <TextBox x:Name="SourcePortTextBox" Watermark="8080" Padding="10" FontSize="12" Background="#3a3a3a" Foreground="#ffffff" BorderBrush="#0d47a1" BorderThickness="1"/>
                                    </StackPanel>
                                    
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="Database:" FontWeight="Bold" Foreground="#e0e0e0" FontSize="12"/>
                                        <TextBox x:Name="SourceDatabaseTextBox" Watermark="database" Padding="10" FontSize="12" Background="#3a3a3a" Foreground="#ffffff" BorderBrush="#0d47a1" BorderThickness="1"/>
                                    </StackPanel>
                                    
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="Username (opzionale):" FontWeight="Bold" Foreground="#e0e0e0" FontSize="12"/>
                                        <TextBox x:Name="SourceUsernameTextBox" Watermark="username" Padding="10" FontSize="12" Background="#3a3a3a" Foreground="#ffffff" BorderBrush="#0d47a1" BorderThickness="1"/>
                                    </StackPanel>
                                    
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="Password (opzionale):" FontWeight="Bold" Foreground="#e0e0e0" FontSize="12"/>
                                        <TextBox x:Name="SourcePasswordTextBox" PasswordChar="â€¢" Watermark="password" Padding="10" FontSize="12" Background="#3a3a3a" Foreground="#ffffff" BorderBrush="#0d47a1" BorderThickness="1"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- Target -->
                            <Border Grid.Row="0" Grid.Column="1" Background="#2a2a2a" CornerRadius="8" Padding="20" BorderBrush="#0d47a1" BorderThickness="2" Margin="15,0,0,0">
                                <StackPanel Spacing="15">
                                    <TextBlock Text="ðŸ“¤ Database Target" FontSize="16" FontWeight="Bold" Foreground="#64b5f6"/>
                                    
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="Tipo Database:" FontWeight="Bold" Foreground="#e0e0e0" FontSize="12"/>
                                        <ComboBox x:Name="TargetTypeCombo" SelectedIndex="2" Padding="10" FontSize="12" Background="#3a3a3a" Foreground="#ffffff" BorderBrush="#0d47a1" BorderThickness="1">
                                            <ComboBoxItem>SqlServer</ComboBoxItem>
                                            <ComboBoxItem>Oracle</ComboBoxItem>
                                            <ComboBoxItem>PostgreSQL</ComboBoxItem>
                                        </ComboBox>
                                    </StackPanel>
                                    
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="Server:" FontWeight="Bold" Foreground="#e0e0e0" FontSize="12"/>
                                        <TextBox x:Name="TargetServerTextBox" Watermark="localhost" Padding="10" FontSize="12" Background="#3a3a3a" Foreground="#ffffff" BorderBrush="#0d47a1" BorderThickness="1"/>
                                    </StackPanel>
                                    
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="Porta:" FontWeight="Bold" Foreground="#e0e0e0" FontSize="12"/>
                                        <TextBox x:Name="TargetPortTextBox" Watermark="8080" Padding="10" FontSize="12" Background="#3a3a3a" Foreground="#ffffff" BorderBrush="#0d47a1" BorderThickness="1"/>
                                    </StackPanel>
                                    
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="Database:" FontWeight="Bold" Foreground="#e0e0e0" FontSize="12"/>
                                        <TextBox x:Name="TargetDatabaseTextBox" Watermark="database" Padding="10" FontSize="12" Background="#3a3a3a" Foreground="#ffffff" BorderBrush="#0d47a1" BorderThickness="1"/>
                                    </StackPanel>
                                    
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="Username (opzionale):" FontWeight="Bold" Foreground="#e0e0e0" FontSize="12"/>
                                        <TextBox x:Name="TargetUsernameTextBox" Watermark="username" Padding="10" FontSize="12" Background="#3a3a3a" Foreground="#ffffff" BorderBrush="#0d47a1" BorderThickness="1"/>
                                    </StackPanel>
                                    
                                    <StackPanel Spacing="5">
                                        <TextBlock Text="Password (opzionale):" FontWeight="Bold" Foreground="#e0e0e0" FontSize="12"/>
                                        <TextBox x:Name="TargetPasswordTextBox" PasswordChar="â€¢" Watermark="password" Padding="10" FontSize="12" Background="#3a3a3a" Foreground="#ffffff" BorderBrush="#0d47a1" BorderThickness="1"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- Connect Button -->
                            <Button Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" x:Name="ConnectButton" Background="#1976d2" Foreground="White" Padding="12" Height="50" FontSize="14" FontWeight="Bold" Margin="0,20,0,0" CornerRadius="4">
                                âœ… Connetti ai Database
                            </Button>
                        </Grid>
                    </ScrollViewer>
                </TabItem>

                <!-- Tab 2: Tables -->
                <TabItem x:Name="TablesTab" Background="#2a2a2a" Foreground="White" Padding="15,10" IsEnabled="False">
                    <TabItem.Header>
                        <TextBlock Text="ðŸ“‹ Selezione Tabelle" FontSize="13" Foreground="White"/>
                    </TabItem.Header>
                    <Grid RowDefinitions="Auto,*,Auto" ColumnDefinitions="*,*" Margin="20,20,20,40" Background="#1a1a1a">
                        <!-- Sorgente: Buttons row -->
                        <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Spacing="10" Margin="15,10,15,15">
                            <Button x:Name="SelectAllButton" Click="SelectAllButton_Click" Background="#1976d2" Foreground="White" Padding="12" Height="40" FontSize="12" FontWeight="Bold" CornerRadius="4">
                                âœ“ Seleziona Tutto
                            </Button>
                            <Button x:Name="DeselectAllButton" Click="DeselectAllButton_Click" Background="#455a64" Foreground="White" Padding="12" Height="40" FontSize="12" FontWeight="Bold" CornerRadius="4">
                                âœ— Deseleziona Tutto
                            </Button>
                        </StackPanel>

                        <!-- Target: Placeholder row -->
                        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="10" Margin="35,0,0,15">
                            <TextBlock Text="ðŸ“Š Tabelle Destinazione (Create Automaticamente)" FontWeight="Bold" Foreground="#64b5f6" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- Sorgente: Tables List -->
                        <Border Grid.Row="1" Grid.Column="0" Background="#2a2a2a" CornerRadius="8" BorderBrush="#0d47a1" BorderThickness="2" Padding="15" Margin="0,0,15,0">
                            <Grid RowDefinitions="Auto,*">
                                <TextBlock Grid.Row="0" Text="ðŸ“¥ Sorgente: Seleziona Tabelle" FontWeight="Bold" Foreground="#64b5f6" FontSize="13" Margin="0,0,0,10"/>
                                <ListBox Grid.Row="1" x:Name="SourceTablesListBox" Background="#1a1a1a" BorderBrush="#0d47a1" BorderThickness="1" Foreground="White">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" Spacing="10" Margin="5,8">
                                                <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}" VerticalAlignment="Center"/>
                                                <TextBlock Text="{Binding Schema}" Foreground="#64b5f6" FontSize="12"/>
                                                <TextBlock Text="." Foreground="#e0e0e0" FontSize="12"/>
                                                <TextBlock Text="{Binding TableName}" Foreground="#e0e0e0" FontSize="12" FontWeight="Bold"/>
                                                <TextBlock Text="{Binding RowCount, StringFormat='({0} righe)'}" Foreground="#9e9e9e" FontSize="11"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </Grid>
                        </Border>

                        <!-- Target: Tables List (Display Only) -->
                        <Border Grid.Row="1" Grid.Column="1" Background="#2a2a2a" CornerRadius="8" BorderBrush="#0d47a1" BorderThickness="2" Padding="15" Margin="15,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <TextBlock Grid.Row="0" Text="ðŸ“¤ Destinazione: Schema da Creare" FontWeight="Bold" Foreground="#64b5f6" FontSize="13" Margin="0,0,0,10"/>
                                <ListBox Grid.Row="1" x:Name="TargetTablesListBox" Background="#1a1a1a" BorderBrush="#0d47a1" BorderThickness="1" Foreground="White">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" Spacing="10" Margin="5,8">
                                                <TextBlock Text="{Binding Schema}" Foreground="#64b5f6" FontSize="12"/>
                                                <TextBlock Text="." Foreground="#a5d6a7" FontSize="12"/>
                                                <TextBlock Text="{Binding TableName}" Foreground="#a5d6a7" FontSize="12" FontWeight="Bold"/>
                                                <TextBlock Text="{Binding RowCount, StringFormat='({0} righe)'}" Foreground="#81c784" FontSize="11"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </Grid>
                        </Border>

                        <!-- Statistics -->
                        <Grid Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" ColumnDefinitions="*,*" Margin="15,5,0,0">
                            <StackPanel Grid.Column="0" Spacing="5">
                                <TextBlock x:Name="SourceCountTextBlock" Foreground="#9e9e9e" FontWeight="Bold" FontSize="12" Text="ðŸ“‹ Tabelle sorgente: 0"/>
                                <TextBlock x:Name="SelectedCountTextBlock" Foreground="#64b5f6" FontWeight="Bold" FontSize="12" Text="âœ“ Tabelle selezionate: 0"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" Spacing="5" Margin="20,0,0,0">
                                <TextBlock x:Name="TargetCountTextBlock" Foreground="#9e9e9e" FontWeight="Bold" FontSize="12" Text="ðŸ“‹ Tabelle destinazione: 0"/>
                                <TextBlock x:Name="TotalRowsTextBlock" Foreground="#a5d6a7" FontWeight="Bold" FontSize="12" Text="ðŸ“Š Righe totali da migrare: 0"/>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </TabItem>

                <!-- Tab 3: Migration -->
                <TabItem x:Name="MigrationTab" Background="#2a2a2a" Foreground="White" Padding="15,10" IsEnabled="False">
                    <TabItem.Header>
                        <TextBlock Text="ðŸš€ Migrazione" FontSize="13" Foreground="White"/>
                    </TabItem.Header>
                    <Grid RowDefinitions="Auto,Auto,*,Auto,Auto,Auto,Auto" Margin="20" Background="#1a1a1a">
                        <!-- Migration Mode Selection -->
                        <Border Grid.Row="0" Background="#2a2a2a" CornerRadius="8" Padding="15" BorderBrush="#ff9800" BorderThickness="2" Margin="0,0,0,15">
                            <StackPanel Spacing="10">
                                <TextBlock Text="âš™ï¸ ModalitÃ  Migrazione:" FontWeight="Bold" FontSize="14" Foreground="#ffb74d"/>
                                <StackPanel Orientation="Horizontal" Spacing="20">
                                    <RadioButton x:Name="ModeSchemaAndData" GroupName="MigrationMode" IsChecked="True" Foreground="#e0e0e0" FontSize="12">
                                        <StackPanel Orientation="Horizontal" Spacing="5">
                                            <TextBlock Text="ðŸ“¦" FontSize="14"/>
                                            <TextBlock Text="Schema + Dati" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </RadioButton>
                                    <RadioButton x:Name="ModeSchemaOnly" GroupName="MigrationMode" Foreground="#e0e0e0" FontSize="12">
                                        <StackPanel Orientation="Horizontal" Spacing="5">
                                            <TextBlock Text="ðŸ—ï¸" FontSize="14"/>
                                            <TextBlock Text="Solo Schema" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </RadioButton>
                                    <RadioButton x:Name="ModeDataOnly" GroupName="MigrationMode" Foreground="#e0e0e0" FontSize="12">
                                        <StackPanel Orientation="Horizontal" Spacing="5">
                                            <TextBlock Text="ðŸ“Š" FontSize="14"/>
                                            <TextBlock Text="Solo Dati" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </RadioButton>
                                </StackPanel>
                                <TextBlock x:Name="MigrationModeDescription" Foreground="#9e9e9e" FontSize="11" TextWrapping="Wrap" 
                                           Text="Crea le tabelle nel database di destinazione e copia tutti i dati. Se la tabella esiste giÃ , verranno copiati solo i dati."/>
                            </StackPanel>
                        </Border>

                        <!-- Selected Tables Summary -->
                        <StackPanel Grid.Row="1" Spacing="8" Margin="0,0,0,15">
                            <TextBlock Text="ðŸ“Š Tabelle da migrare:" FontWeight="Bold" FontSize="13" Foreground="#64b5f6"/>
                            <TextBlock Text="{Binding SelectedTablesCount, StringFormat='Tabelle selezionate: {0}'}" Foreground="#e0e0e0" FontSize="12"/>
                            <TextBlock Text="{Binding TotalRowsToMigrate, StringFormat='Righe totali: {0}'}" Foreground="#e0e0e0" FontSize="12"/>
                            <ListBox Background="#2a2a2a" Foreground="#e0e0e0" MaxHeight="120" ItemsSource="{Binding Tables}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="10">
                                            <TextBlock IsVisible="{Binding IsSelected}" Text="âœ“" Foreground="#43a047" FontSize="11"/>
                                            <TextBlock FontSize="11" Foreground="#e0e0e0" Text="{Binding TableName}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </StackPanel>
                        
                        <Border Grid.Row="2" Background="#2a2a2a" CornerRadius="8" Padding="15" BorderBrush="#0d47a1" BorderThickness="1" Margin="0,15,0,0">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <StackPanel Spacing="10">
                                    <TextBlock Text="ðŸ“ Status:" FontWeight="Bold" FontSize="13" Foreground="#64b5f6"/>
                                    <TextBlock x:Name="StatusTextBlock" Foreground="#e0e0e0" TextWrapping="Wrap" FontSize="12" MinHeight="100" Text="Pronto"/>
                                </StackPanel>
                            </ScrollViewer>
                        </Border>
                        
                        <StackPanel Grid.Row="3" Spacing="8" Margin="0,15,0,0">
                            <ProgressBar x:Name="ProgressBar" Value="0" Maximum="100" Height="30" Foreground="#43a047" Background="#3a3a3a"/>
                            <TextBlock x:Name="ProgressTextBlock" TextAlignment="Center" FontWeight="Bold" Foreground="#43a047" FontSize="12" Text="0%"/>
                        </StackPanel>
                        
                        <Button x:Name="StartMigrationButton" Grid.Row="4" Background="#1976d2" Foreground="White" Padding="12" Height="50" FontSize="16" FontWeight="Bold" Margin="15,15,0,0" CornerRadius="4" IsEnabled="False">
                            ðŸš€ Avvia Migrazione
                        </Button>
                        
                        <TextBlock Grid.Row="5" Foreground="#9e9e9e" TextWrapping="Wrap" FontSize="11" Margin="0,15,0,0" Text="â„¹ï¸ Seleziona le tabelle nel tab 'Selezione Tabelle' e scegli la modalitÃ  di migrazione."/>
                        
                        <Border Grid.Row="6" Background="#1b5e20" CornerRadius="5" Padding="12" BorderBrush="#43a047" BorderThickness="1" Margin="0,15,0,0">
                            <TextBlock x:Name="ErrorTextBlock" Foreground="#a5d6a7" TextWrapping="Wrap" FontSize="11" Text=""/>
                        </Border>
                    </Grid>
                </TabItem>
            </TabControl>

            <!-- Status Bar -->
            <Border Grid.Row="1" Background="#0d47a1" Padding="15" Margin="0,20,0,0">
                <TextBlock x:Name="StatusBarTextBlock" Foreground="White" FontSize="12" Text="Pronto"/>
            </Border>
        </Grid>
    </DockPanel>
</Window>
